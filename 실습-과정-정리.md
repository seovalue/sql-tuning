# SQL 미션
1. 200개 이상 팔린 상품명과 그 수량을 수량 기준 내림차순  
   상품명 -> Product - ProductName  
   개수 -> OrderDetails - Quantity  

```sql
select p.ProductID as '상품아이디', p.ProductName as '상품이름', sum(od.Quantity) as '총수량'
from Products p, OrderDetails od
where p.ProductID = od.ProductID
group by p.ProductID
having `총수량` >= 200
order by `총수량` desc;
```

* where 절에 equal은 `==`가 아니라 `=`다. Thanks to 인비

2. 많이 주문한 순으로 고객 리스트(ID, 고객명)를 구해주세요. (고객별 구매한 물품 총 갯수)    
   고객 ID -> Customers.CustomerID  
   고객명 -> Customers.CustomerName   
   주문에서 고객아이디 -> Orders.CustomerID    
   주문에서 OrderID -> Orders.OrderID  
   주문디테일에서 OrderID -> OrderDetails.OrderID  
   주문디테일에서 구매 수량 -> OrderDetails.Quantity  

```sql
select c.CustomerID as '고객아이디', c.CustomerName as '고객이름', sum(od.Quantity) as '주문량'
from Orders o, Customers c, OrderDetails od
where o.CustomerID = c.CustomerID 
and o.OrderID = od.OrderID
group by c.CustomerID
order by `주문량` desc;
```

3. 많은 돈을 지출한 순으로 고객 리스트를 구해주세요.  
   고객 ID -> Customers.CustomerID  
   고객명 -> Customers.CustomerName  
   지출금액 -> 고객별 구매 목록 * price의 합계  
   가격 -> Products.Price  
   주문에서 고객아이디 -> Orders.CustomerID  
   주문에서 OrderID -> Orders.OrderID  
   주문디테일에서 OrderID -> OrderDetails.OrderID  
   주문디테일에서 구매 수량 -> OrderDetails.Quantity  
  
고객 CustomerID가 어떤 구매를 했는가?  
-> Orders.CustomerID  
-> Orders.OrderID  
OrderID를 몇개나 구매했는가  
-> OrderDetails.Quantity  
어떤 Product를 구매했는가  
-> OrderDetails.ProductID  
그 Product는 얼마인가  
-> Products.Price  
  
### 1차 시도 - 실패
```sql
select c.CustomerID as '고객아이디', c.CustomerName as '고객이름', od.Quantity*p.Price as '지출금액'
from Orders o, Customers c, Products p, OrderDetails od
where o.CustomerID = c.CustomerID 
and o.OrderID = od.OrderID
and od.ProductID = p.ProductID
group by c.CustomerID
order by `지출금액` desc;
```

### 2차 시도 - 실패
```sql
select c.CustomerID as '고객아이디', c.CustomerName as '고객이름', sum(od.Quantity)*p.Price as '지출금액'
from Orders o, Customers c, Products p, OrderDetails od
where o.CustomerID = c.CustomerID 
and o.OrderID = od.OrderID
and od.ProductID = p.ProductID
group by c.CustomerID
order by `지출금액` desc;
```

### 3차 시도
```sql
select c.CustomerID as '고객아이디', c.CustomerName as '고객이름', 
(select sum(od.Quantity)*p.Price
from Products p, OrderDetails od
where p.ProductID = od.ProductID
group by p.ProductID) as '지출금액'
from Orders o, Customers c
where o.CustomerID = c.CustomerID 
group by c.CustomerID
order by `지출금액` desc;
```

### 4차 시도
```sql
select c.CustomerID as '고객아이디', c.CustomerName as '고객이름', 
(select sum(od.Quantity) 
from Customer c, Orders o, OrderDetails od
where c.CustomerID = o.CustomerID
and o.OrderID = od.OrderID
group by c.CustomerID)*p.Price
as '지출금액'
from Orders o, Customers c
where o.CustomerID = c.CustomerID 
group by c.CustomerID
order by `지출금액` desc;
```

## 5차 시도!!! 성공
2차 시도에서 sum을 잘못 걸어줬었다. 흐극
```sql
select c.CustomerID as '고객아이디', c.CustomerName as '고객이름', sum(od.Quantity*p.Price) as '지출금액'
from Orders o, Customers c, Products p, OrderDetails od
where o.CustomerID = c.CustomerID 
and o.OrderID = od.OrderID
and od.ProductID = p.ProductID
group by c.CustomerID
order by `지출금액` desc;
```
